var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},Game=function(t){function e(){var e=t.call(this)||this;return e._info=new Info,e._totalStepCount=5,e._lifeCount=555,e._stepBeginX=200,e._score=0,e._stepsArray=[],e._letterArray=[],e._letterTFArray=[],e._letterImgArray=[],e._allWords=[],e._person=new Bitmap("beibei_png"),e._personBeginPoint=new egret.Point(0,0),e._personTopY=350,e._personWH=110,e._guideLine=new egret.Shape,e._guideArrow=new Bitmap("step_png"),e._historyArrow=new Bitmap("step_png"),e._touchBeginPoint=new egret.Point(0,0),e._guideMaxLength=200,e._isHit=!1,e.addEventListener(egret.Event.ADDED_TO_STAGE,e.createGameScene,e),e}return __extends(e,t),e.prototype.createGameScene=function(){var t=new GameBackground(this.stage.stageWidth,this.stage.stageHeight);this.addChild(t),this._info._vuid=localStorage.getItem("vuid").replace(/"/g,""),this._info._key=localStorage.getItem("key").replace(/"/g,""),this._info._isfrom=localStorage.getItem("isfrom").replace(/"/g,""),this._info._timenum=localStorage.getItem("timenum").replace(/"/g,""),this._info._activitynum=localStorage.getItem("activitynum").replace(/"/g,""),this.minusGameCount()},e.prototype.getWords=function(t){var e="?vuid="+this._info._vuid+"&key="+this._info._key+"&rands="+this._rands+"&isfrom="+this._info._isfrom,i=new egret.HttpRequest;i.responseType=egret.HttpResponseType.TEXT,i.open(this._info._getWord+e,egret.HttpMethod.GET),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.send(),i.addEventListener(egret.Event.COMPLETE,function(){console.log(JSON.parse(i.response));var e=JSON.parse(i.response);if(0==e.code){if(3==t){this._wordTF.text="单词：";for(var s=0;s<this._letterTFArray.length;s++)this.removeChild(this._stepsArray[s]);for(var r=0;r<this._letterTFArray.length;r++)this.removeChild(this._letterTFArray[r]),this.removeChild(this._letterImgArray[r]);this._letterArray.splice(0,this._letterArray.length),this._letterTFArray.splice(0,this._letterTFArray.length),this._letterImgArray.splice(0,this._letterImgArray.length),this._stepsArray.splice(0,this._stepsArray.length)}for(var n=[],s=0;s<e.data.length;s++)n.push(e.data[s].word);Array.prototype.push.apply(this._allWords,n);var o=n.join().replace(/,/g,"").replace(/ /g,"").toLowerCase();console.log("this._allWords="+this._allWords);var h=o.split("");Array.prototype.push.apply(this._letterArray,h),1==t?(this.setupSteps(),this.setupPerson(),this.setupReminder(),this.addTouchEvent()):3==t&&this.setupSteps()}else alert("请求出错-"+e.msg)},this)},e.prototype.setupSteps=function(){this._stepBeginX=200;var t=new Bitmap("step_png");t.width=130,t.height=30,t.y=this._personTopY+this._personWH,t.x=this._stepBeginX-t.width/2,this.addChild(t),this._stepsArray.push(t);for(var e=t.x,i=0;i<this._totalStepCount;i++){var s=new Bitmap("step_png");s.width=130,s.height=30,s.y=this._personTopY+this._personWH,s.x=e+s.width+50+300*Math.random(),this.addChild(s),this._stepsArray.push(s),e=s.x;var r=new egret.TextField;r.x=s.x,r.y=s.y-40,r.width=30,r.height=40,r.text=this._letterArray[i],r.alpha=0,this.addChild(r),this._letterTFArray.push(r);var n=new Bitmap("letter_json."+r.text);n.width=60,n.height=60,n.y=s.y-60,n.x=s.x+35,this.addChild(n),this._letterImgArray.push(n)}this._letterArray.splice(0,this._totalStepCount)},e.prototype.setupPerson=function(){this._person.width=this._personWH,this._person.height=this._personWH,this._person.x=this._stepBeginX-this._person.width/2,this._person.y=this._personTopY,this.addChild(this._person),this._personBeginPoint.x=this._person.x+this._personWH/2,this._personBeginPoint.y=this._person.y+this._personWH,this._guideArrow=new Bitmap("step_png"),this._guideArrow.y=this._personBeginPoint.y,this._guideArrow.x=this._personBeginPoint.x,this._guideArrow.width=0,this._guideArrow.height=0},e.prototype.setupReminder=function(){var t=new Bitmap("wordBg_png");t.x=.3*this.stage.stageWidth,t.y=0,t.width=.4*this.stage.stageWidth,t.height=100,this.addChild(t),this._wordTF=new egret.TextField,this._wordTF.x=.25*this.stage.stageWidth,this._wordTF.y=30,this._wordTF.width=.5*this.stage.stageWidth,this._wordTF.height=50,this._wordTF.textColor=16737792,this._wordTF.textAlign=egret.HorizontalAlign.CENTER,this._wordTF.size=32,this._wordTF.text="单词：",this._wordTF.fontFamily="Microsoft YaHei",this.addChild(this._wordTF),this._scoreTF=new egret.TextField,this._scoreTF.x=.25*this.stage.stageWidth,this._scoreTF.y=120,this._scoreTF.width=.5*this.stage.stageWidth,this._scoreTF.height=55,this._scoreTF.textColor=2118730,this._scoreTF.textAlign=egret.HorizontalAlign.CENTER,this._scoreTF.size=30,this._scoreTF.text="您已经走了"+this._score+"米",this._scoreTF.fontFamily="Microsoft YaHei",this.addChild(this._scoreTF);var e=new egret.Sound;e.addEventListener(egret.Event.COMPLETE,function(){this._backgroundChannel=e.play(0,0),this._backgroundChannel.volume=.7},this),e.load("resource/sound/bg.mp3")},e.prototype.gameTimerCompleteFunc=function(){this.removeTouchEvent(),this.gameOver(),this._backgroundChannel&&this._backgroundChannel.stop()},e.prototype.addTouchEvent=function(){this.stage.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touchBegin,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.touchEnd,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.touchMove,this)},e.prototype.removeTouchEvent=function(){this.stage.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touchBegin,this),this.stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.touchEnd,this),this.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.touchMove,this)},e.prototype.touchBegin=function(t){this._touchBeginPoint.x=t.localX,this._touchBeginPoint.y=t.localY,this._isHit=!1},e.prototype.touchMove=function(t){this._guideLine.graphics.clear(),this._guideArrow.width=0,this._guideArrow.height=0,this._guideArrow.rotation=0,t.localY<0&&(this._touchMoveToY=0),this._touchMoveToX=this._personBeginPoint.x+(t.localX-this._touchBeginPoint.x),this._touchMoveToY=this._personBeginPoint.y+(t.localY-this._touchBeginPoint.y);var e=Math.pow(this._touchMoveToX-this._personBeginPoint.x,2),i=Math.pow(this._touchMoveToY-this._personBeginPoint.y,2);if(this._guideTruthLength=Math.sqrt(e+i),this._guideTruthLength>this._guideMaxLength){this._guideTruthLength=this._guideMaxLength;var s=t.localX-this._touchBeginPoint.x,r=t.localY-this._touchBeginPoint.y,n=Math.sqrt(s*s+r*r),o=this._guideMaxLength*s/n,h=this._guideMaxLength*r/n;this._touchMoveToX=this._personBeginPoint.x+o,this._touchMoveToY=this._personBeginPoint.y+h}this._touchMoveToX<this._personBeginPoint.x&&(this._touchMoveToX=this._personBeginPoint.x,this._touchMoveToY=this._personBeginPoint.y-this._guideTruthLength),this._touchMoveToY>this._personBeginPoint.y&&(this._touchMoveToY=this._personBeginPoint.y,this._touchMoveToX=this._personBeginPoint.x+this._guideTruthLength);var a=(this._touchMoveToX-this._personBeginPoint.x)/(this._personBeginPoint.y-this._touchMoveToY),_=90-180*Math.atan(a)/Math.PI;this._guideArrow.width=this._guideTruthLength,this._guideArrow.height=10,this._guideArrow.rotation=-_;var d=this._personBeginPoint.x+(this._touchMoveToX-this._personBeginPoint.x)/2,p=this._personBeginPoint.y+(this._touchMoveToY-this._personBeginPoint.y)/2-10;this._guideLine.graphics.lineStyle(3,0),this._guideLine.graphics.moveTo(this._personBeginPoint.x,this._personBeginPoint.y),this._guideLine.graphics.curveTo(d,p,this._touchMoveToX,this._touchMoveToY),this._guideLine.graphics.endFill(),this._guideLine.alpha=.3,this.addChild(this._guideLine)},e.prototype.touchEnd=function(t){this._guideLine.graphics.clear(),this._guideArrow.width=0,this._guideArrow.height=0,this._guideArrow.rotation=0;var e=(this._touchMoveToX-this._personBeginPoint.x)/(this._personBeginPoint.y-this._touchMoveToY),i=90-180*Math.atan(e)/Math.PI;this._historyArrow.y=this._personBeginPoint.y,this._historyArrow.x=this._personBeginPoint.x,this._historyArrow.width=this._guideTruthLength,this._historyArrow.height=10,this._historyArrow.rotation=-i,this._historyArrow.alpha=.2,this.removeTouchEvent(),this._pathHighX=this._personBeginPoint.x+5*(this._touchMoveToX-this._personBeginPoint.x),this._pathHighY=this._personBeginPoint.y-this._personWH-4*(this._personBeginPoint.y-this._touchMoveToY),egret.Tween.get(this).to({factor:1},1e3).call(function(){if(0==this._isHit){var t=this._stepsArray[0];this._person.x=t.x+t.width/2-this._person.width/2,this._person.y=this._personTopY,this._lifeCount-=1,0==this._lifeCount&&this.gameTimerCompleteFunc();var e=new egret.Sound;e.addEventListener(egret.Event.COMPLETE,function(){e.play(0,1)},this),e.load("resource/sound/down.mp3")}this.addTouchEvent()},this);var s=new egret.Sound;s.addEventListener(egret.Event.COMPLETE,function(){var t=s.play(0,1);t.volume=.7},this),s.load("resource/sound/jump.mp3")},Object.defineProperty(e.prototype,"factor",{get:function(){return 0},set:function(t){this._person.x=(1-t)*(1-t)*this._personBeginPoint.x+2*t*(1-t)*this._pathHighX+t*t*(2*this._pathHighX-this._personBeginPoint.x),this._person.y=(1-t)*(1-t)*(this._personBeginPoint.y-this._personWH)+2*t*(1-t)*(this._pathHighY-300)+t*t*(this.stage.stageHeight-this._personWH),this.checkHit()},enumerable:!0,configurable:!0}),e.prototype.checkHit=function(){for(var t=0;t<this._stepsArray.length;t++){var e=this._stepsArray[t],i=e.hitTestPoint(this._person.x+this._person.width/2,this._person.y+this._person.height,!0);i&&this.hitAction(t)}},e.prototype.hitAction=function(t){this._historyArrow&&this._historyArrow.parent&&this._historyArrow.parent.removeChild(this._historyArrow),this._person.y=this._personTopY,egret.Tween.removeTweens(this),this._isHit=!0;var e=this._stepsArray[t].x+this._stepsArray[t].width/2-this._stepBeginX;if(t>0){console.log("发生碰撞时"+this._letterTFArray.length);var i=this._letterTFArray[t-1];this.addLetter(i.text)}this._score+=Math.round(e/100),this._scoreTF.text="您已经走了"+this._score+"米",this.plusScore(Math.round(e/100));for(var s=0;s<this._stepsArray.length;s++){var r=this._stepsArray[s];egret.Tween.get(r).to({x:r.x-e},300)}for(var n=0;n<this._letterTFArray.length;n++){var o=this._letterTFArray[n];egret.Tween.get(o).to({x:o.x-e},300);var h=this._letterImgArray[n];egret.Tween.get(h).to({x:h.x-e},300)}egret.Tween.get(this._person).to({x:this._stepBeginX-this._person.width/2},300),this._hitIndex=t;var a=new egret.Timer(310,1);a.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.stepTweenComplete,this),a.start()},e.prototype.stepTweenComplete=function(){for(var t=0;t<this._hitIndex;t++)this._stepsArray[t]&&this._stepsArray[t].parent&&this._stepsArray[t].parent.removeChild(this._stepsArray[t]);this._stepsArray.splice(0,this._hitIndex);for(var t=0;t<this._hitIndex;t++)this._letterTFArray[t]&&this._letterTFArray[t].parent&&(this._letterTFArray[t].parent.removeChild(this._letterTFArray[t]),this._letterImgArray[t].parent.removeChild(this._letterImgArray[t]));this._letterTFArray.splice(0,this._hitIndex),this._letterImgArray.splice(0,this._hitIndex);for(var e=this._stepsArray[this._stepsArray.length-1],i=e.x,t=0;t<this._hitIndex;t++){var s=new Bitmap("step_png");s.y=this._personTopY+this._personWH,s.x=i+s.width+300*Math.random(),s.width=130,s.height=30,this.addChild(s),i=s.x,this._stepsArray.push(s);var r=new egret.TextField;r.x=s.x,r.y=s.y-40,r.width=30,r.height=40,r.text=this._letterArray[t],r.alpha=0,this.addChild(r),this._letterTFArray.push(r);var n=new Bitmap("letter_json."+r.text);n.width=60,n.height=60,n.y=s.y-60,n.x=s.x+35,this.addChild(n),this._letterImgArray.push(n)}this._letterArray.splice(0,this._hitIndex),this._letterArray.length<10&&this.getWords(2),this.addTouchEvent(),this._hitIndex>1&&(console.log("隔着跳了"),this.getWords(3))},e.prototype.addLetter=function(t){this._wordTF.text.replace("单词：","");this._wordTF.text+=t;for(var e=0;e<this._allWords.length;e++){var i=this._allWords[e].replace(".","").replace(" ","").toLowerCase();this.checkWord(i)}},e.prototype.checkWord=function(t){if(this._wordTF.text.replace("单词：","").replace(".","")==t){this.removeTouchEvent(),this.plusScore(50);var e=new Bitmap("bingo_png");e.x=520,e.y=180,e.width=210,e.height=107,this.addChild(e);var i=new egret.HttpRequest;i.responseType=egret.HttpResponseType.TEXT,i.open("http://www.iciba.com/index.php?a=getWordMean&c=search&word=apple",egret.HttpMethod.GET),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.send(),i.addEventListener(egret.Event.COMPLETE,function(){var t=JSON.parse(i.response);if(t.baesInfo.symbols.length>0){var e=t.baesInfo.symbols[0].ph_am_mp3,s=new egret.Sound;s.addEventListener(egret.Event.COMPLETE,function(){s.play(0,1)},this),s.load(e)}},this);var s=new egret.Timer(500,1);s.addEventListener(egret.TimerEvent.TIMER_COMPLETE,function(){this.addChild(new GameSpeedMotion(this.stage.stageWidth)),this.addTouchEvent();var t=new egret.Timer(300,1);t.addEventListener(egret.TimerEvent.TIMER_COMPLETE,function(){this._score+=50,this._scoreTF.text="您已经走了"+this._score+"米",this._wordTF.text="单词："},this),t.start(),e&&e.parent&&e.parent.removeChild(e)},this),s.start()}},e.prototype.plusScore=function(t){var e="?vuid="+this._info._vuid+"&rands="+this._rands+"&tid="+this._tid+"&md5="+t+"&timenum="+this._info._timenum+"&activitynum="+this._info._activitynum+"&isfrom="+this._info._isfrom,i=new egret.HttpRequest;i.responseType=egret.HttpResponseType.TEXT,i.open(this._info._typosTempjump,egret.HttpMethod.POST),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.send(e),i.addEventListener(egret.Event.COMPLETE,function(){console.log(JSON.parse(i.response))},this)},e.prototype.minusGameCount=function(){var t="?vuid="+this._info._vuid+"&key="+this._info._key+"&timenum="+this._info._timenum+"&activitynum="+this._info._activitynum+"&isfrom="+this._info._isfrom,e=new egret.HttpRequest;e.responseType=egret.HttpResponseType.TEXT,e.open(this._info._downnum+t,egret.HttpMethod.GET),console.log(this._info._downnum+t),e.send(),e.addEventListener(egret.Event.COMPLETE,function(){console.log(JSON.parse(e.response));var t=JSON.parse(e.response);0==t.code?(this._linnum=parseInt(t.data.linnum),this._rands=parseInt(t.data.rands),this._tid=parseInt(t.data.tid),this.getWords(1)):alert("请求出错-"+t.msg)},this)},e.prototype.gameOver=function(){var t="?score="+this._score+"&vuid="+this._info._vuid+"&key="+this._info._key+"&rands="+this._rands+"&timenum="+this._info._timenum+"&activitynum="+this._info._activitynum+"&isfrom="+this._info._isfrom,e=new egret.HttpRequest;e.responseType=egret.HttpResponseType.TEXT,console.log(this._info._gameover+t),e.open(this._info._gameover+t,egret.HttpMethod.GET),e.send(),e.addEventListener(egret.Event.COMPLETE,function(){var t=JSON.parse(e.response);this._normalAlert=new Alert(Alert.GamePageScore,this._score.toString(),t.data.score,t.data.order,t.data.text,this.stage.stageHeight),this._normalAlert.x=250,this._normalAlert.y=-100,this._normalAlert.addEventListener(AlertEvent.Ranking,this.checkRanking,this),this._normalAlert.addEventListener(AlertEvent.Restart,this.restartGame,this),this.addChild(this._normalAlert)},this),e.addEventListener(egret.IOErrorEvent.IO_ERROR,function(){},this)},e.prototype.checkRanking=function(){console.log("game 查看排名"),this._normalAlert&&this._normalAlert.parent&&this._normalAlert.parent.removeChild(this._normalAlert),window.location.href="https://www.beisu100.com/beisuapp/gamerank/rank/timenum/"+this._info._timenum+"/activitynum/"+this._info._activitynum+"/vuid/"+this._info._vuid+"/key/"+this._info._key+"/isfrom/"+this._info._isfrom},e.prototype.restartGame=function(){console.log("game 重玩"),this.removeChildren(),this._score=0,this._stepsArray.splice(0,this._stepsArray.length),this._letterArray.splice(0,this._letterArray.length),this._letterTFArray.splice(0,this._letterTFArray.length),this._letterImgArray.splice(0,this._letterImgArray.length),this._allWords.splice(0,this._allWords.length),this.createGameScene()},e}(egret.DisplayObjectContainer);__reflect(Game.prototype,"Game");var GameBackground=function(t){function e(e,i){var s=t.call(this)||this,r=new egret.Sprite;r.graphics.beginFill(13692905,1),r.graphics.drawRect(0,0,e,i),r.graphics.endFill(),s.addChild(r);var n=new Bitmap("game_bottom_png");n.x=0,n.y=i-250,n.width=e,n.height=250,s.addChild(n);var o=new Bitmap("yun03_png");o.x=250,o.y=150,o.width=144,o.height=82,s.addChild(o),egret.Tween.get(o,{loop:!0}).to({x:e},5e4).to({x:-200},5e4);var h=new Bitmap("yun02_png");h.x=340,h.y=500,h.width=73,h.height=44,s.addChild(h),egret.Tween.get(h,{loop:!0}).to({x:-100},3e4).to({x:e},3e4);var a=new Bitmap("yun04_png");return a.x=40,a.y=200,a.width=112,a.height=76,s.addChild(a),egret.Tween.get(a,{loop:!0}).to({x:e},4e4).to({x:-120},4e4),s}return __extends(e,t),e}(egret.Sprite);__reflect(GameBackground.prototype,"GameBackground");var GameSpeedMotion=function(t){function e(e){var i=t.call(this)||this;i.count=5,i.index=0,i._person=new Bitmap("beibei_png"),i._stageW=e,i._person.width=110,i._person.height=110,i._person.x=145,i._person.y=350,i.addChildAt(i._person,99),egret.Tween.get(i._person).to({x:i._stageW-150,y:250},1e3);var s=new egret.Timer(300,i.count);s.addEventListener(egret.TimerEvent.TIMER,i.timerFunc,i),s.start();var r=new egret.Sound;return r.addEventListener(egret.Event.COMPLETE,function(){this._channel=r.play(0,0)},i),r.load("resource/sound/rocket.mp3"),i}return __extends(e,t),e.prototype.timerFunc=function(t){this.index+=1,this.speedImage&&this.speedImage.parent&&this.speedImage.parent.removeChild(this.speedImage),this.speedImage=new Bitmap("speed1_png"),this.speedImage.width=this._stageW,this.addChild(this.speedImage),this.swapChildren(this.speedImage,this._person);var e=new egret.Timer(100,1);e.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.timerComFunc1,this),e.start()},e.prototype.timerComFunc1=function(t){this.speedImage&&this.speedImage.parent&&this.speedImage.parent.removeChild(this.speedImage),this.speedImage=new Bitmap("speed2_png"),this.speedImage.width=this._stageW,this.addChild(this.speedImage),this.swapChildren(this.speedImage,this._person);var e=new egret.Timer(100,1);e.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.timerComFunc2,this),e.start()},e.prototype.timerComFunc2=function(t){this.speedImage&&this.speedImage.parent&&this.speedImage.parent.removeChild(this.speedImage),this.speedImage=new Bitmap("speed3_png"),this.speedImage.width=this._stageW,this.addChild(this.speedImage),this.swapChildren(this.speedImage,this._person),this.index==this.count&&(this.speedImage&&this.speedImage.parent&&this.speedImage.parent.removeChild(this.speedImage),this._person&&this._person.parent&&this._person.parent.removeChild(this._person),this._channel.stop())},e}(egret.Sprite);__reflect(GameSpeedMotion.prototype,"GameSpeedMotion");var Home=function(t){function e(){var e=t.call(this)||this;return e._playCount=-1,e._isPortraitScreen=!1,e._info=new Info,e._pageUrl=window.location.href,e.addEventListener(egret.Event.ADDED_TO_STAGE,e.createGameScene,e),e}return __extends(e,t),e.prototype.createGameScene=function(){var t=window.navigator.userAgent.toLowerCase();"micromessenger"==t.match(/MicroMessenger/i)?this.stage.setContentSize(1218,750):/(iPhone|iPad|iPod|iOS)/i.test(navigator.userAgent)?this.stage.setContentSize(1218,750):/(Android)/i.test(navigator.userAgent)&&this.stage.setContentSize(1334,750);var e=new Bitmap("bg_png");e.width=this.stage.stageWidth,e.height=this.stage.stageHeight,this.addChild(e),this.getUserInfo()},e.prototype.getUserInfo=function(){this._pageUrl="http://ceshi.beisu100.com//actity/90001/index.html?uid=68384&key=72270ed2b481ad4070af0d26dca64c60&isfrom=0&activitynum=9&timenum=1";var t=this.getUrlParams();this._info._vuid=t.uid,this._info._key=t.key,this._info._isfrom=t.isfrom,this._info._timenum=t.timenum,this._info._activitynum=t.activitynum,localStorage.setItem("vuid",JSON.stringify(this._info._vuid)),localStorage.setItem("key",JSON.stringify(this._info._key)),localStorage.setItem("isfrom",JSON.stringify(this._info._isfrom)),localStorage.setItem("timenum",JSON.stringify(this._info._timenum)),localStorage.setItem("activitynum",JSON.stringify(this._info._activitynum)),this.setupUI(),0==parseInt(this._info._isfrom)&&this.getUserCanPalyNumber(),null==this._info._key&&alert("请先登录！")},e.prototype.setupUI=function(){if(0==parseInt(this._info._isfrom)){var t=new egret.TextField;t.x=this._isPortraitScreen?375:550,t.y=this._isPortraitScreen?600:375,t.textFlow=[{text:"手指移动控制倍倍方向，根据记忆力判断正确位置，掉落即游戏结束。按照最高分进行排名，排名前50都有红包奖励。此外，还会随机抽取100名发送幸运红包哦~",style:{textColor:2579281,size:28}},{text:"分享给好友，让好友为你加油，可增加机会呦~",style:{textColor:16737792,size:28}}],t.lineSpacing=15,t.width=600,t.anchorOffsetX=t.width/2,t.anchorOffsetY=t.height/2,t.rotation=this._isPortraitScreen?0:-90,this.addChild(t),this._playNumText=new egret.TextField,this._playNumText.size=30,this._playNumText.x=this._isPortraitScreen?230:700,this._playNumText.y=this._isPortraitScreen?755:500,this._playNumText.rotation=this._isPortraitScreen?0:-90,this._playNumText.textColor=2579281,this._playNumText.anchorOffsetX=this._playNumText.width/2,this._playNumText.anchorOffsetY=this._playNumText.height/2,this._playNumText.text="您当前有0次挑战机会",this.addChild(this._playNumText),this._startButton=new Bitmap("gamebody_json.start"),this._startButton.x=this._isPortraitScreen?180:780,this._startButton.y=this._isPortraitScreen?820:570,this._startButton.rotation=this._isPortraitScreen?0:-90,this._startButton.touchEnabled=!0,this._startButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.startPlayGame,this),this.addChild(this._startButton),this._rankButton=new Bitmap("gamebody_json.ranking"),this._rankButton.x=this._isPortraitScreen?180:950,this._rankButton.y=this._isPortraitScreen?990:570,this._rankButton.rotation=this._isPortraitScreen?0:-90,this._rankButton.touchEnabled=!0,this._rankButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.checkRanking,this),this.addChild(this._rankButton)}else 1==parseInt(this._info._isfrom)&&(this._startButton=new Bitmap("gamebody_json.start"),this._startButton.x=this._isPortraitScreen?180:600,this._startButton.y=this._isPortraitScreen?760:570,this._startButton.rotation=this._isPortraitScreen?0:-90,this._startButton.touchEnabled=!0,this._startButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.startPlayGame,this),this.addChild(this._startButton),this._rankButton=new Bitmap("gamebody_json.ranking"),this._rankButton.x=this._isPortraitScreen?180:800,this._rankButton.y=this._isPortraitScreen?910:570,this._rankButton.rotation=this._isPortraitScreen?0:-90,this._rankButton.touchEnabled=!0,this._rankButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.checkRanking,this),this.addChild(this._rankButton))},e.prototype.checkRanking=function(t){console.log("查看排名"),window.location.href="https://www.beisu100.com/beisuapp/gamerank/rank/timenum/"+this._info._timenum+"/activitynum/"+this._info._activitynum+"/vuid/"+this._info._vuid+"/key/"+this._info._key+"/isfrom/"+this._info._isfrom},e.prototype.startPlayGame=function(t){console.log("开始游戏"),this._rankButton.touchEnabled=!1,this._startButton.touchEnabled=!1,0==parseInt(this._info._isfrom)?this.checkIsAttention():(this.removeChildren(),this.addChild(new Game))},e.prototype.getUserCanPalyNumber=function(){var t="?vuid="+this._info._vuid+"&key="+this._info._key+"&timenum="+this._info._timenum+"&activitynum="+this._info._activitynum+"&isfrom="+this._info._isfrom,e=new egret.HttpRequest;e.responseType=egret.HttpResponseType.TEXT,e.open(this._info._canPalyNumber+t,egret.HttpMethod.GET),e.send(),e.addEventListener(egret.Event.COMPLETE,function(){var t=JSON.parse(e.response);0==t.code&&(this._playCount=t.data.num,this._playNumText.text="您当前有"+this._playCount+"次挑战机会",0!=t.data.isend&&(this.removeChild(this._startButton),this._overButton=new Bitmap("gamebody_json.ending"),this._overButton.x=this._isPortraitScreen?180:780,this._overButton.y=this._isPortraitScreen?820:570,this._overButton.rotation=this._isPortraitScreen?0:-90,this._overButton.touchEnabled=!0,this._overButton.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){alert("活动已结束")},this),this.addChild(this._overButton)))},this),e.addEventListener(egret.IOErrorEvent.IO_ERROR,function(){alert("post error : "+event),this._rankButton.touchEnabled=!0,this._startButton.touchEnabled=!0},this)},e.prototype.checkIsAttention=function(){var t="?vuid="+this._info._vuid+"&timenum="+this._info._timenum+"&activitynum="+this._info._activitynum+"&isfrom="+this._info._isfrom,e=new egret.HttpRequest;e.responseType=egret.HttpResponseType.TEXT,e.open(this._info._hasAttention+t,egret.HttpMethod.GET),e.send(),e.addEventListener(egret.Event.COMPLETE,function(){var t=JSON.parse(e.response);0==t.code?this._playCount>0?(this.removeChildren(),this.addChild(new Game)):(this._alert=new Alert(Alert.HomePageShare,"","","",0,this.stage.stageHeight),this._alert.x=this._isPortraitScreen?0:110,this._alert.y=this._isPortraitScreen?0:750,this._alert.rotation=this._isPortraitScreen?0:-90,this._alert.addEventListener(AlertEvent.Share,this.shareButtonClick,this),this._alert.addEventListener(AlertEvent.Cancle,this.cancleButtonClick,this),this.addChild(this._alert)):2==t.code&&(this._rankButton.touchEnabled=!0,this._startButton.touchEnabled=!0,document.getElementById("attention").style.display="block")},this),e.addEventListener(egret.IOErrorEvent.IO_ERROR,function(){alert("post error : "+event),this._rankButton.touchEnabled=!0,this._startButton.touchEnabled=!0},this)},e.prototype.cancleButtonClick=function(){this._rankButton.touchEnabled=!0,this._startButton.touchEnabled=!0,this.removeChild(this._alert)},e.prototype.shareButtonClick=function(){this.removeChild(this._alert);var t=new Bitmap("shareGui_png");t.touchEnabled=!0,t.x=(this._isPortraitScreen,0),t.y=this._isPortraitScreen?0:this.stage.stageHeight,t.width=this._isPortraitScreen?this.stage.stageWidth:this.stage.stageHeight,t.height=this._isPortraitScreen?this.stage.stageHeight:this.stage.stageWidth,t.rotation=this._isPortraitScreen?0:-90,t.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){this.removeChild(t),this._rankButton.touchEnabled=!0,this._startButton.touchEnabled=!0},this),this.addChild(t)},e.prototype.getUrlParams=function(){var t=this._pageUrl.indexOf("?"),e=this._pageUrl.substring(t),i=decodeURIComponent(e),s=new Object;if(-1!=i.indexOf("?"))for(var r=i.substr(1),n=r.split("&"),o=0;o<n.length;o++)s[n[o].split("=")[0]]=unescape(n[o].split("=")[1]);return s},e}(egret.DisplayObjectContainer);__reflect(Home.prototype,"Home");var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e._isPortraitScreen=!1,e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.textField=new egret.TextField,this.textField.x=this._isPortraitScreen?0:600,this.textField.y=this._isPortraitScreen?300:750,this.textField.width=750,this.textField.height=100,this.textField.textAlign="center",this.textField.rotation=this._isPortraitScreen?0:-90,this.addChild(this.textField)},e.prototype.setProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var Main=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(t){this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},e.prototype.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("preload")},e.prototype.onResourceLoadComplete=function(t){"preload"==t.groupName&&(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.createGameScene())},e.prototype.onItemLoadError=function(t){console.warn("Url:"+t.resItem.url+" has failed to load")},e.prototype.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},e.prototype.onResourceProgress=function(t){"preload"==t.groupName&&this.loadingView.setProgress(t.itemsLoaded,t.itemsTotal)},e.prototype.createGameScene=function(){this.addChild(new Home),RES.getResAsync("description_json",this.startAnimation,this)},e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},e.prototype.startAnimation=function(t){},e}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var Alert=function(t){function e(e,i,s,r,n,o){var h=t.call(this)||this;return h.type=e,h.score=i,h.highScore=s,h.ranking=r,h.descstate=n,h.screenwith=o,h.initView(),h}return __extends(e,t),e.prototype.initView=function(){var t=new Bitmap("alert_bg");switch(t.height=this.screenwith,this.addChild(t),this.type){case 1:var e=new Bitmap("gamebody_json.prompt_03");this.addChild(e),e.x=370,e.y=480,e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2;var i=new egret.TextField;i.x=370,i.y=460,i.size=30,i.fontFamily="Microsoft YaHei",i.verticalAlign=egret.VerticalAlign.BOTTOM,i.textColor=16724307,i.text="五次机会已经用完了哦~分享给好友，让好友为你加油，就可以获得重玩的机会呦~",i.lineSpacing=10,i.width=400,i.anchorOffsetX=i.width/2,i.anchorOffsetY=i.height/2,this.addChild(i);var s=new Bitmap("gamebody_json.btn_03");this.addChild(s),s.x=230,s.y=610,s.anchorOffsetX=s.width/2,s.anchorOffsetY=s.height/2,s.touchEnabled=!0,s.addEventListener(egret.TouchEvent.TOUCH_TAP,this.cancleShareGame,this);var r=new Bitmap("gamebody_json.btn_05");this.addChild(r),r.x=510,r.y=610,r.anchorOffsetX=r.width/2,r.anchorOffsetY=r.height/2,r.touchEnabled=!0,r.addEventListener(egret.TouchEvent.TOUCH_TAP,this.shareGame,this);break;case 2:var n=new Bitmap("gamebody_json.tan");if(this.addChild(n),n.x=370,n.y=480,n.anchorOffsetX=n.width/2,n.anchorOffsetY=n.height/2,1==this.descstate){var o=new egret.TextField;o.x=140,o.y=380,o.size=32,o.fontFamily="Microsoft YaHei",o.verticalAlign=egret.VerticalAlign.BOTTOM,o.textFlow=[{text:"防作弊系统检测:",style:{textColor:8006727,size:22}},{text:"成绩无效,如有问题,请联系客服",style:{textColor:16719360,size:22}}],o.anchorOffsetY=o.height/2,this.addChild(o)}var h=new egret.TextField;h.x=420,h.y=420,h.size=42,h.fontFamily="Microsoft YaHei",h.verticalAlign=egret.VerticalAlign.BOTTOM,h.textColor=16729701,h.text=this.score,h.anchorOffsetX=h.width/2,h.anchorOffsetY=h.height/2,this.addChild(h);var a=new egret.TextField;a.x=415,a.y=470,a.size=32,a.fontFamily="Microsoft YaHei",a.verticalAlign=egret.VerticalAlign.BOTTOM,a.textColor=11947535,a.text=this.highScore,a.anchorOffsetX=a.width/2,a.anchorOffsetY=a.height/2,this.addChild(a);var _=new egret.TextField;_.x=400,_.y=520,_.size=32,_.fontFamily="Microsoft YaHei",_.verticalAlign=egret.VerticalAlign.BOTTOM,_.textColor=11947535,_.text=this.ranking,_.anchorOffsetY=_.height/2,this.addChild(_);var d=new Bitmap("gamebody_json.list");this.addChild(d),d.x=230,d.y=610,d.anchorOffsetX=d.width/2,d.anchorOffsetY=d.height/2,d.touchEnabled=!0,d.addEventListener(egret.TouchEvent.TOUCH_TAP,this.gotoRanking,this);var p=new Bitmap("gamebody_json.return");this.addChild(p),p.x=510,p.y=610,p.anchorOffsetX=p.width/2,p.anchorOffsetY=p.height/2,p.touchEnabled=!0,p.addEventListener(egret.TouchEvent.TOUCH_TAP,this.reastGame,this);
break;case 3:var g=new Bitmap("gamebody_json.prompt_03");this.addChild(g),g.x=370,g.y=480,g.anchorOffsetX=g.width/2,g.anchorOffsetY=g.height/2;var l=new egret.TextField;l.x=370,l.y=460,l.size=30,l.fontFamily="Microsoft YaHei",l.verticalAlign=egret.VerticalAlign.BOTTOM,l.textColor=16724307,l.text="五次机会已经用完了哦~分享给好友，让好友为你加油，就可以获得重玩的机会呦~",l.lineSpacing=10,l.width=400,l.anchorOffsetX=l.width/2,l.anchorOffsetY=l.height/2,this.addChild(l);var c=new Bitmap("gamebody_json.btn_03");this.addChild(c),c.x=230,c.y=610,c.anchorOffsetX=c.width/2,c.anchorOffsetY=c.height/2,c.touchEnabled=!0,c.addEventListener(egret.TouchEvent.TOUCH_TAP,this.cancleShareGame,this);var u=new Bitmap("gamebody_json.btn_05");this.addChild(u),u.x=510,u.y=610,u.anchorOffsetX=u.width/2,u.anchorOffsetY=u.height/2,u.touchEnabled=!0,u.addEventListener(egret.TouchEvent.TOUCH_TAP,this.shareGame,this)}},e.prototype.gotoRanking=function(){var t=new AlertEvent(AlertEvent.Ranking);this.dispatchEvent(t)},e.prototype.reastGame=function(){var t=new AlertEvent(AlertEvent.Restart);this.dispatchEvent(t)},e.prototype.shareGame=function(){var t=new AlertEvent(AlertEvent.Share);this.dispatchEvent(t)},e.prototype.cancleShareGame=function(){var t=new AlertEvent(AlertEvent.Cancle);this.dispatchEvent(t)},e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},e}(egret.Sprite);Alert.HomePageShare=1,Alert.GamePageScore=2,Alert.GamePageShare=3,__reflect(Alert.prototype,"Alert");var AlertEvent=function(t){function e(e,i,s){return void 0===i&&(i=!1),void 0===s&&(s=!1),t.call(this,e,i,s)||this}return __extends(e,t),e}(egret.Event);AlertEvent.Share="share",AlertEvent.Ranking="ranking",AlertEvent.Restart="restart",AlertEvent.Cancle="cancle",__reflect(AlertEvent.prototype,"AlertEvent");var Bitmap=function(t){function e(e){var i=(t.call(this)||this,new egret.Bitmap),s=RES.getRes(e);return i.texture=s,i}return __extends(e,t),e}(egret.Bitmap);__reflect(Bitmap.prototype,"Bitmap");var Info=function(){function t(){this._url="http://ceshi.beisu100.com/beisuapp",this._hasAttention=this._url+"/uservote/isguanzhu",this._canPalyNumber=this._url+"/typos/num",this._downnum=this._url+"/typos/numdown5",this._gameover=this._url+"/typos/GameOver",this._typosTempjump=this._url+"/typos/typosTempjump",this._getWord=this._url+"/typos/getjumpwords",this._searchWord="http://ceshi.beisu100.com/querylist/getwordslist/l/"}return t}();__reflect(Info.prototype,"Info");